<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.MDシミュレーションの実行 &mdash; MDnotes  ドキュメント</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="3.シミュレーション結果の解析" href="GROMACStutorial1.3.html" />
    <link rel="prev" title="1. シミュレーションの準備" href="GROMACStutorial1.1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MDnotes
            <img src="../_static/MDnoteslogo.jfif" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Simulation Introduction</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="GROMACSinstall.html">GROMACSのインストール</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="GROMACSindex1.html">GROMACSチュートリアル1</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="GROMACSindex1.html#id1">目次</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="GROMACStutorial1.1.html">1. シミュレーションの準備</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.MDシミュレーションの実行</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">エネルギー最小化</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nvt">NVT平衡化</a></li>
<li class="toctree-l4"><a class="reference internal" href="#npt">NPT平衡化</a></li>
<li class="toctree-l4"><a class="reference internal" href="#production-run">本計算（Production Run）</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">まとめ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="GROMACStutorial1.3.html">3.シミュレーション結果の解析</a></li>
<li class="toctree-l3"><a class="reference internal" href="GROMACStutorial1.4.html">4.【補足】トポロジーファイルの詳細</a></li>
<li class="toctree-l3"><a class="reference internal" href="GROMACStutorial1.5.html">5.【補足】mdpファイルの詳細</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="GROMACSindex2.html">GROMACSチュートリアル2</a></li>
<li class="toctree-l1"><a class="reference internal" href="GROMACSmdp.html">GROMACS.mdpオプション</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VMD/VMDindex.html">VMDの使い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GNUPLOT/GNUPLOTusage.html">gnuplotの使い方</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Molecular Dynamics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../MD/mdsoft.html">Molecular Dynamics Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/gromacs.html">Gromacs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/namd.html">Namd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/lammps.html">LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/mpdyn.html">MPDyn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plot/Gnuplot_01.html">Gnuplotでグラフ作成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/vmd.html">VMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/Discovery_studio.html">Discovery Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/fftw.html">FFTW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/plumed.html">PLUMED</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/packmol.html">Packmol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/MPI.html">MPI environment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../slack/insto.html">slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../device/main.html">Device in Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../make_homepages/how_to_use_git.html">How to edit this homepages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../make_homepages/sandbox.html">Sandbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SPHINX/sphinxindex.html">Sphinxの使い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GIT/gitindex.html">Gitの使い方</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Cheat sheet</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GROMACScheat.html">GROMACSチートシート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VMD/VMDcheat.html">VMDチートシート</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Room</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python/matplotlib.html">matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/MDAnalysis.html">MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/MDAnalysis_tutorial.html">MDAnalysis tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/anaconda.html">Anaconda</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Polymer Group</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Polymer/polymer_property.html">高分子材料の物性値の調整</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDnotes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="GROMACSindex1.html">GROMACSチュートリアル1</a> &raquo;</li>
      <li>2.MDシミュレーションの実行</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="md">
<h1>2.MDシミュレーションの実行<a class="headerlink" href="#md" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>前回、水とイオンの入ったボックス内にタンパク質が含まれる系を作成した。 今回はいよいよ、実際にMD計算を行っていく。</p>
<p>はじめに、MD計算の大まかな手順を解説する。 MD計算では系を作成した後、エネルギー最小化、平衡化を経てようやく本計算を行うことになる。 本計算の前に作成した系の構造を安定化しておくことで、シミュレーションをより現実の系に近づけることが可能となる。</p>
<ol class="simple">
<li><p>エネルギー最小化</p></li>
<li><p>NVT平衡化</p></li>
<li><p>NPT平衡化</p></li>
<li><p>本計算（Production Run）</p></li>
</ol>
<section id="id1">
<h2>エネルギー最小化<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>系が作成できたら、まずはエネルギー最小化（Energy minimization）を行う。 これは、系に立体的な衝突や不適切なジオメトリがないように構造緩和を行う操作である。
エネルギー最小化のための入力ファイルはtprファイルであり、<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">grommp</span></code>を使用して用意する。 エネルギー最小化における設定ファイルであるminim.mdpを<a class="reference external" href="https://shalad2.github.io/JellyPage/gromacs/download/minim.mdp">ここ</a>からダウンロードし、系の構造ファイル、トポロジーファイルとともに<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">grommp</span></code>を実行する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">grompp</span> <span class="o">-</span><span class="n">f</span> <span class="n">minim</span><span class="o">.</span><span class="n">mdp</span> <span class="o">-</span><span class="n">c</span> <span class="mi">1</span><span class="n">AKI_solv_ions</span><span class="o">.</span><span class="n">gro</span> <span class="o">-</span><span class="n">p</span> <span class="n">topol</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span><span class="n">o</span> <span class="n">em</span><span class="o">.</span><span class="n">tpr</span>
</pre></div>
</div>
<p>前回のイオンの追加ではtprファイルを<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">genion</span></code>に渡したが、エネルギー最小化では<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">mdrun</span></code>を用いる。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">gmx mdrunオプション</th>
<th align="center">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-v</td>
<td align="center">計算ステップを画面表示する</td>
</tr>
<tr>
<td align="center">-deffnm</td>
<td align="center">入力ファイル名と出力ファイル名の指定</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">mdrun</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">deffnm</span> <span class="n">em</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">mdrun</span></code>の実行が終了すると、以下のファイルが得られる。</p>
<ol class="simple">
<li><p>em.log : エネルギー最小化のログファイル</p></li>
<li><p>em.edr : バイナリのエネルギーファイル</p></li>
<li><p>em.trr : バイナリのトラジェクトリファイル</p></li>
<li><p>em.gro : エネルギー最小化が完了した構造ファイル</p></li>
</ol>
<p>エネルギー最小化が成功しているかを判断するために、画面に出力されたポテンシャルエネルギーEpotと最大力Fmaxの値を確認しておく。</p>
<p>まず、ポテンシャルエネルギーEpotは負の値であり、系の大きさや水分子の数によるが、105から106のオーダーとなる。 また、最大力Fmaxは1000 kJ mol-1 nm-1以下の値となる。 これはmdpファイルにおいて、最大力がが1000 kJ mol-1 nm-1より小さくなるまでエネルギー最小化を行うように設定したためである。 mdpファイルの詳細については【mdpファイルの詳細】を参照してほしい。</p>
<p>ここで、エネルギー最小化におけるポテンシャルエネルギーの変化を調べてみる。 <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code>を用いると、バイナリのエネルギーファイルem.edrからポテンシャルエネルギーのデータを取り出すことができる。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">gmx energyオプション</th>
<th align="center">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-f</td>
<td align="center">入力edrファイルの指定</td>
</tr>
<tr>
<td align="center">-o</td>
<td align="center">出力ファイルの指定</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">energy</span> <span class="o">-</span><span class="n">f</span> <span class="n">em</span><span class="o">.</span><span class="n">edr</span> <span class="o">-</span><span class="n">o</span> <span class="n">potential</span><span class="o">.</span><span class="n">xvg</span>
</pre></div>
</div>
<p>対話形式で出力するエネルギーの種類を聞かれるので<code class="docutils literal notranslate"><span class="pre">10</span></code>（Potential）を入力し、終了のために<code class="docutils literal notranslate"><span class="pre">0</span></code>を追加で入力すると（<code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">0</span></code>としてEnter）、画面にEtotの平均値が表示され、potential.xvgにポテンシャルエネルギーが書き込まれる。 potential.xvgをグラフにプロットすると、エネルギー最小化のステップに伴ってポテンシャルエネルギーが安定に収束していることを確認できる。</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/1aki_em_plot.png" width=50%><p>これにて系のエネルギーが最小化されたので、実際のダイナミクスに取り掛かる。</p>
</section>
<section id="nvt">
<h2>NVT平衡化<a class="headerlink" href="#nvt" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>次のステップはNVT平衡化である。 実際のダイナミクスを行うためには、タンパク質周りの溶媒とイオンを平衡化しなければならない。 ここではNVTアンサンブルを適用して、300 Kで100 psの平衡化を行う。</p>
<p>NVT平衡化はエネルギー最小化と同様に<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">grompp</span></code>と<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">mdrun</span></code>を用いて行う。 NVT平衡化の<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">grompp</span></code>に必要なmdpファイルは<a class="reference external" href="https://shalad2.github.io/JellyPage/gromacs/download/nvt.mdp">ここ</a>からダウンロードする。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">gmx grommpオプション</th>
<th align="center">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-r</td>
<td align="center">位置拘束パラメータの付与</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">grompp</span> <span class="o">-</span><span class="n">f</span> <span class="n">nvt</span><span class="o">.</span><span class="n">mdp</span> <span class="o">-</span><span class="n">c</span> <span class="n">em</span><span class="o">.</span><span class="n">gro</span> <span class="o">-</span><span class="n">r</span> <span class="n">em</span><span class="o">.</span><span class="n">gro</span> <span class="o">-</span><span class="n">p</span> <span class="n">topol</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span><span class="n">o</span> <span class="n">nvt</span><span class="o">.</span><span class="n">tpr</span>
<span class="n">gmx</span> <span class="n">mdrun</span> <span class="o">-</span><span class="n">deffnm</span> <span class="n">nvt</span>
</pre></div>
</div>
<p>NVT平衡化における<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">grompp</span></code>では<code class="docutils literal notranslate"><span class="pre">-r</span></code>オプションに構造ファイルを指定することで、構造ファイルの座標に前回作成したposre.itpを適用し、タンパク質の重たい原子に対して位置拘束のパラメータを付与している。 これにより、タンパク質の構造変化を記述するための変数を追加することなく溶媒の平衡化を行うことができる。</p>
<p>NVT平衡化が完了したら、系の温度制御が正しく行われていることを確認する。 <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code>で<code class="docutils literal notranslate"><span class="pre">16</span></code>（Temperature）と<code class="docutils literal notranslate"><span class="pre">0</span></code>を選択してtemperature.xvgを出力する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">energy</span> <span class="o">-</span><span class="n">f</span> <span class="n">nvt</span><span class="o">.</span><span class="n">edr</span> <span class="o">-</span><span class="n">o</span> <span class="n">temperature</span><span class="o">.</span><span class="n">xvg</span>
</pre></div>
</div>
<p>グラフにプロットすると、系の温度がすぐに300 Kに達し、100 psの平衡化の間で安定していることを確認できる。</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/1aki_temp_plot.png" width=50%></section>
<section id="npt">
<h2>NPT平衡化<a class="headerlink" href="#npt" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>NVT平衡化により系の温度が安定したら、続いてNPT平衡化により圧力制御を行う。 NPTアンサンブルを用いて、300 K、1 barで100 psの平衡化を行う。</p>
<p>NVT平衡化と同様に<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">grompp</span></code>と<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">mdrun</span></code>を行う。 NPT平衡化のためのmdpファイルは<a class="reference external" href="https://shalad2.github.io/JellyPage/gromacs/download/npt.mdp">ここ</a>からダウンロードして使用する。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">gmx grommpオプション</th>
<th align="center">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-t</td>
<td align="center">チェックポイントファイルの指定</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">grompp</span> <span class="o">-</span><span class="n">f</span> <span class="n">npt</span><span class="o">.</span><span class="n">mdp</span> <span class="o">-</span><span class="n">c</span> <span class="n">nvt</span><span class="o">.</span><span class="n">gro</span> <span class="o">-</span><span class="n">r</span> <span class="n">nvt</span><span class="o">.</span><span class="n">gro</span> <span class="o">-</span><span class="n">t</span> <span class="n">nvt</span><span class="o">.</span><span class="n">cpt</span> <span class="o">-</span><span class="n">p</span> <span class="n">topol</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span><span class="n">o</span> <span class="n">npt</span><span class="o">.</span><span class="n">tpr</span>
<span class="n">gmx</span> <span class="n">mdrun</span> <span class="o">-</span><span class="n">deffnm</span> <span class="n">npt</span>
</pre></div>
</div>
<p>ここで<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">grompp</span></code>において<code class="docutils literal notranslate"><span class="pre">-t</span></code>オプションを指定している。 これはNVT平衡化からシミュレーションを継続するためのチェックポイントファイル（cptファイル）を指定するものであり、NVT平衡化により生成した速度を引き継いでNPT平衡化を行うことができる。</p>
<p>NPT平衡化が完了したら、今度は系の圧力制御が正しく行われていることを確認する。 <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code>で<code class="docutils literal notranslate"><span class="pre">18</span></code>（Pressure）と<code class="docutils literal notranslate"><span class="pre">0</span></code>を選択してpressure.xvgを出力する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">energy</span> <span class="o">-</span><span class="n">f</span> <span class="n">npt</span><span class="o">.</span><span class="n">edr</span> <span class="o">-</span><span class="n">o</span> <span class="n">pressure</span><span class="o">.</span><span class="n">xvg</span>
</pre></div>
</div>
<p>グラフにプロットすると、圧力の変動はかなり大きいことが確認できる。 今回設定した基準圧力が1 barであるのに対して、平衡化での平均値は-25.6±157.9 barとなっている。 このように、圧力はMD計算において大きく変動する量であることを注記しておく。</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/1aki_press_plot.png" width=50%><p>同様にして、密度変化も確認しておく。 <code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">energy</span></code>で<code class="docutils literal notranslate"><span class="pre">24</span></code>（Density）と<code class="docutils literal notranslate"><span class="pre">0</span></code>を選択し、出力されたdensity.xvgをグラフにプロットする。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">energy</span> <span class="o">-</span><span class="n">f</span> <span class="n">npt</span><span class="o">.</span><span class="n">edr</span> <span class="o">-</span><span class="n">o</span> <span class="n">density</span><span class="o">.</span><span class="n">xvg</span>
</pre></div>
</div>
<p>密度の平均値は1018±3 kg m-3であり、実験値の1000 kg m-3やSPC/E水モデルの1008 kg m-3と近い値になっている。 密度の値は100 psの間非常に安定しており、これで系は圧力と密度に関して平衡化されたと判断することができる。</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/1aki_dens_plot.png" width=50%></section>
<section id="production-run">
<h2>本計算（Production Run）<a class="headerlink" href="#production-run" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>NVT平衡化、NPT平衡化のステップが完了すると、系は目的の温度と圧力で十分に平衡化されている。 ここからはようやく、シミュレーションデータを収集するための本計算（Production run）を行う。 今回は300 K、1 barを保ったまま1 nsのシミュレーションを行い、構造の変化とその軌跡をデータとして出力する。</p>
<p><code class="docutils literal notranslate"><span class="pre">-r</span></code>で指定していた平衡化での位置拘束を外し、<code class="docutils literal notranslate"><span class="pre">-t</span></code>でNPT平衡化のチェックポイントファイルを指定して<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">grompp</span></code>と<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">mdrun</span></code>を行う。 本計算のためのmdpファイルは<a class="reference external" href="https://shalad2.github.io/JellyPage/gromacs/download/md.mdp">ここ</a>からダウンロードして使用する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">grompp</span> <span class="o">-</span><span class="n">f</span> <span class="n">md</span><span class="o">.</span><span class="n">mdp</span> <span class="o">-</span><span class="n">c</span> <span class="n">npt</span><span class="o">.</span><span class="n">gro</span> <span class="o">-</span><span class="n">t</span> <span class="n">npt</span><span class="o">.</span><span class="n">cpt</span> <span class="o">-</span><span class="n">p</span> <span class="n">topol</span><span class="o">.</span><span class="n">top</span> <span class="o">-</span><span class="n">o</span> <span class="n">md_0_1</span><span class="o">.</span><span class="n">tpr</span>
<span class="n">gmx</span> <span class="n">mdrun</span> <span class="o">-</span><span class="n">deffnm</span> <span class="n">md_0_1</span>
</pre></div>
</div>
<p>計算が終了すると、最終的な構造ファイルと1 nsのトラジェクトリファイルが出力される。 以降はこれらのファイルを用いて、様々な解析を行うことになる。</p>
</section>
<section id="id2">
<h2>まとめ<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>今回はMD計算の一連の流れを見てきた。手順をまとめておく。</p>
<ol class="simple">
<li><p>エネルギー最小化により、系の構造緩和を行った。</p></li>
<li><p>NVT平衡化を行い、系の温度制御がなされていることを確認した。</p></li>
<li><p>NPT平衡化を行い、系の圧力制御がなされていることを確認した。</p></li>
<li><p>本計算を行い、解析に使用するシミュレーションデータを得た。</p></li>
</ol>
<p>次回は得られたデータを用いた分析の例を示していく。</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="GROMACStutorial1.1.html" class="btn btn-neutral float-left" title="1. シミュレーションの準備" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="GROMACStutorial1.3.html" class="btn btn-neutral float-right" title="3.シミュレーション結果の解析" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, I.Kawabata, S.Harada, H.Tanaka.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>