<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.シミュレーション結果の解析 &mdash; MDnotes  ドキュメント</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="4.【補足】トポロジーファイルの詳細" href="GROMACStutorial1.4.html" />
    <link rel="prev" title="2.MDシミュレーションの実行" href="GROMACStutorial1.2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MDnotes
            <img src="../_static/MDnoteslogo.jfif" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Simulation Introduction</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="GROMACSinstall.html">GROMACSのインストール</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="GROMACSindex1.html">GROMACSチュートリアル1</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="GROMACSindex1.html#id1">目次</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="GROMACStutorial1.1.html">1. シミュレーションの準備</a></li>
<li class="toctree-l3"><a class="reference internal" href="GROMACStutorial1.2.html">2.MDシミュレーションの実行</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">3.シミュレーション結果の解析</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">トラジェクトリの修正</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rmsd">RMSD</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">回転半径</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">まとめ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="GROMACStutorial1.4.html">4.【補足】トポロジーファイルの詳細</a></li>
<li class="toctree-l3"><a class="reference internal" href="GROMACStutorial1.5.html">5.【補足】mdpファイルの詳細</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="GROMACSindex2.html">GROMACSチュートリアル2</a></li>
<li class="toctree-l1"><a class="reference internal" href="GROMACSmdp.html">GROMACS.mdpオプション</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VMD/VMDindex.html">VMDの使い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GNUPLOT/GNUPLOTusage.html">gnuplotの使い方</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Molecular Dynamics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../MD/mdsoft.html">Molecular Dynamics Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/gromacs.html">Gromacs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/namd.html">Namd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/lammps.html">LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/mpdyn.html">MPDyn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plot/Gnuplot_01.html">Gnuplotでグラフ作成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/vmd.html">VMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/Discovery_studio.html">Discovery Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/fftw.html">FFTW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/plumed.html">PLUMED</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/packmol.html">Packmol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MD/MPI.html">MPI environment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../slack/insto.html">slack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../device/main.html">Device in Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../make_homepages/how_to_use_git.html">How to edit this homepages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../make_homepages/sandbox.html">Sandbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SPHINX/sphinxindex.html">Sphinxの使い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GIT/gitindex.html">Gitの使い方</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Cheat sheet</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GROMACScheat.html">GROMACSチートシート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VMD/VMDcheat.html">VMDチートシート</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Room</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python/matplotlib.html">matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/MDAnalysis.html">MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/MDAnalysis_tutorial.html">MDAnalysis tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/anaconda.html">Anaconda</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Polymer Group</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Polymer/polymer_property.html">高分子材料の物性値の調整</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDnotes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="GROMACSindex1.html">GROMACSチュートリアル1</a> &raquo;</li>
      <li>3.シミュレーション結果の解析</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>3.シミュレーション結果の解析<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>前回までで、水とイオンが入ったボックス内のタンパク質のMDシミュレーションを行った。 今回は得られた最終構造とトラジェクトリを用いて、いくつかの分析をしてみる。</p>
<ol class="simple">
<li><p>トラジェクトリの修正</p></li>
<li><p>RMSD</p></li>
<li><p>回転半径</p></li>
</ol>
<section id="id2">
<h2>トラジェクトリの修正<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>まずシミュレーションが正しく終了し、トラジェクトリファイル（md_0_1.xtc）が生成していることを確認する。 トラジェクトリファイルはシミュレーション中の全原子の軌跡を記録したファイルであり、GROMACSにはtrrファイルとxtcファイルの形式がある。</p>
<ol class="simple">
<li><p>trrファイル : 原子の位置と速度の情報を含むバイナリファイル</p></li>
<li><p>xtcファイル : 原子の位置のみの情報を含むバイナリファイル</p></li>
</ol>
<p>しかしながらVMDでトラジェクトリを確認すると、周期的境界条件により原子がボックスの反対側へジャンプするため、結合が正しく描画されない。 そこで<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">trjconv</span></code>を使用して、トラジェクトリの座標や周期性を修正する。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">gmx trjconvオプション</th>
<th align="center">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-s</td>
<td align="center">入力tprファイルの指定</td>
</tr>
<tr>
<td align="center">-f</td>
<td align="center">入力（修正前）トラジェクトリファイルの指定</td>
</tr>
<tr>
<td align="center">-o</td>
<td align="center">出力（修正後）トラジェクトリファイルの指定</td>
</tr>
<tr>
<td align="center">-pbc</td>
<td align="center">周期的境界条件の処理タイプの指定（molは分子の重心をボックス内に入れる）</td>
</tr>
<tr>
<td align="center">-center</td>
<td align="center">指定したグループをボックス中心に配置</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">trjconv</span> <span class="o">-</span><span class="n">s</span> <span class="n">md_0_1</span><span class="o">.</span><span class="n">tpr</span> <span class="o">-</span><span class="n">f</span> <span class="n">md_0_1</span><span class="o">.</span><span class="n">xtc</span> <span class="o">-</span><span class="n">o</span> <span class="n">md_0_1_noPBC</span><span class="o">.</span><span class="n">xtc</span> <span class="o">-</span><span class="n">pbc</span> <span class="n">mol</span> <span class="o">-</span><span class="n">center</span>
</pre></div>
</div>
<p>コマンドを実行すると中心に配置するグループを聞かれるので<code class="docutils literal notranslate"><span class="pre">1</span></code>（Protein）を選択し、さらにトラジェクトリを出力するグループとして<code class="docutils literal notranslate"><span class="pre">0</span></code>（System）を選択する。 修正後の「md_0_1_noPBC.xtc」をVMDで確認すると、先ほどまで見えていた結合の線が消え、見やすいトラジェクトリとなっていることがわかる。</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/1aki_trjconv_before.png" width=50%><p>Before : md_0_1.xtc</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/1aki_trjconv_after.png" width=50%><p>After : md_0_1_noPBC.xtc</p>
<p>これでトラジェクトリファイルの修正は完了である。 今回は1 nsのシミュレーションを行っており、10 psごとに座標を出力している。VMDで動きを確認してみよう。</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/lysozyme.gif" width=50%></section>
<section id="rmsd">
<h2>RMSD<a class="headerlink" href="#rmsd" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>RMSDは平均二乗偏差（Root Mean Square Deviation）のことで、タンパク質の構造の非類似性を定量化したものである。 ここではタンパク質のダイナミクスにおいて、対応する各原子のずれの平均二乗偏差を考え、タンパク質の構造安定性を議論する。 修正したトラジェクトリファイルを用いて、<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">rms</span></code>によりRMSDを計算する。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">gmx rmsオプション</th>
<th align="center">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-s</td>
<td align="center">入力tprファイルの指定（ここでの構造が参照される）</td>
</tr>
<tr>
<td align="center">-f</td>
<td align="center">入力トラジェクトリファイルの指定（ここでの構造と比較する）</td>
</tr>
<tr>
<td align="center">-o</td>
<td align="center">出力ファイルの指定</td>
</tr>
<tr>
<td align="center">-tu</td>
<td align="center">時間単位の指定（デフォルトはps、今回はns）</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">rms</span> <span class="o">-</span><span class="n">s</span> <span class="n">md_0_1</span><span class="o">.</span><span class="n">tpr</span> <span class="o">-</span><span class="n">f</span> <span class="n">md_0_1_noPBC</span><span class="o">.</span><span class="n">xtc</span> <span class="o">-</span><span class="n">o</span> <span class="n">rmsd</span><span class="o">.</span><span class="n">xvg</span> <span class="o">-</span><span class="n">tu</span> <span class="n">ns</span>
</pre></div>
</div>
<p>最小二乗法とRMSD計算の対象グループに<code class="docutils literal notranslate"><span class="pre">4</span></code>（Backbone）を選択すると、平衡化されたタンパク質の構造を参照して水溶液中でのタンパク質のRMSDが計算され、rmsd.xvgが出力される。 同様にして、結晶状態（ダイナミクスを行う前）のタンパク質の構造を参照して、RMSDを計算してみる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">rms</span> <span class="o">-</span><span class="n">s</span> <span class="n">em</span><span class="o">.</span><span class="n">tpr</span> <span class="o">-</span><span class="n">f</span> <span class="n">md_0_1_noPBC</span><span class="o">.</span><span class="n">xtc</span> <span class="o">-</span><span class="n">o</span> <span class="n">rmsd_xtal</span><span class="o">.</span><span class="n">xvg</span> <span class="o">-</span><span class="n">tu</span> <span class="n">ns</span>
</pre></div>
</div>
<p>rmsd_xtal.xvgが得られたら、両者を重ねてグラフにプロットしてみる。</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/1aki_rmsd_plot.png" width=50%><p>どちらのRMSDも約0.1 nm（1 Å）まで低下しており、タンパク質の構造が十分に安定化していることを示している。 また、プロット間の微妙な違いは平衡化されたタンパク質の構造が結晶状態の構造とわずかに異なることに起因している。 これは平衡化の過程での位置拘束が完全なものではないことや、エネルギー最小化された構造が必ずしも安定構造ではないことから予想される。</p>
</section>
<section id="id3">
<h2>回転半径<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>タンパク質の回転半径Rgは、そのタンパク質がどのくらいコンパクトであるか（折り畳まれているか）を表す指標である。 タンパク質が安定に折り畳まれてる場合、Rgは比較的一定の値を維持する。 一方でタンパク質が展開した場合、Rgは時間とともに変化する値となる。 ここでは<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">gyrate</span></code>を用いて回転半径を計算する。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">gmx gyrateオプション</th>
<th align="center">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-s</td>
<td align="center">入力tprファイルの指定</td>
</tr>
<tr>
<td align="center">-f</td>
<td align="center">入力トラジェクトリファイルの指定</td>
</tr>
<tr>
<td align="center">-o</td>
<td align="center">出力ファイルの指定</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">gyrate</span> <span class="o">-</span><span class="n">s</span> <span class="n">md_0_1</span><span class="o">.</span><span class="n">tpr</span> <span class="o">-</span><span class="n">f</span> <span class="n">md_0_1_noPBC</span><span class="o">.</span><span class="n">xtc</span> <span class="o">-</span><span class="n">o</span> <span class="n">gyrate</span><span class="o">.</span><span class="n">xvg</span>
</pre></div>
</div>
<p>回転半径の計算の対象グループとして<code class="docutils literal notranslate"><span class="pre">1</span></code>（Protein）を選択し、出力されたgyrate.xvgをグラフにプロットする。</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/1aki_rg_plot.png" width=50%><p>タンパク質の回転半径は300 Kで1 nsにわたってほぼ一定であり、タンパク質は折り畳まれた状態で安定していることがわかる。</p>
</section>
<section id="id4">
<h2>まとめ<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>今回はタンパク質のMD計算の結果を用いて、いくつかの分析をしてきた。</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">trjconv</span></code>でトラジェクトリの修正を行った。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">rms</span></code>でタンパク質のRMSDを計算した。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">gyrate</span></code>でタンパク質の回転半径を計算した。</p></li>
</ol>
<p>シミュレーション結果を分析する時、目的の物理量を得るためにプログラムを自作することも多い。 しかしながら、一般的に調べられている物理量であれば、GROMACSなどのソフトウェアが提供するプログラムを利用するのも強力である。 GROMACSが提供するその他のコマンドについては<a class="reference external" href="https://manual.gromacs.org/archive/5.0.2/programs/bytopic.html">こちら</a>を参照してほしい。</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="GROMACStutorial1.2.html" class="btn btn-neutral float-left" title="2.MDシミュレーションの実行" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="GROMACStutorial1.4.html" class="btn btn-neutral float-right" title="4.【補足】トポロジーファイルの詳細" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, S.Yoshida, I.Kawabata, S.Harada, H.Tanaka.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>