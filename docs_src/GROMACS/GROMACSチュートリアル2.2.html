

<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>2. 力場パラメータとトポロジーの準備 &mdash; MDnotes  ドキュメント</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="3. mdpファイルの作成とシミュレーションの実行" href="GROMACS%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB2.3.html" />
    <link rel="prev" title="1. 系の作成" href="GROMACS%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB2.1.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MDnotes
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="GROMACS%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB.html">GROMACSのインストール</a></li>
<li class="toctree-l1"><a class="reference internal" href="GROMACSindex1.html">GROMACSチュートリアル1</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="GROMACSindex2.html">GROMACSチュートリアル2</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="GROMACSindex2.html#id1">目次</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="GROMACS%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB2.1.html">1. 系の作成</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2. 力場パラメータとトポロジーの準備</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#charmm">CHARMM力場のダウンロード</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gro">構造ファイル（groファイル）の作成</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">まとめ</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="GROMACS%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB2.3.html">3. mdpファイルの作成とシミュレーションの実行</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="GROMACSmdp%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3.html">GROMACS.mdpオプション</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SPHINX/sphinxindex.html">Sphinxの使い方</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GIT/gitindex.html">Gitの使い方</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MDnotes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="GROMACSindex2.html">GROMACSチュートリアル2</a> &raquo;</li>
        
      <li>2. 力場パラメータとトポロジーの準備</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>2. 力場パラメータとトポロジーの準備<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>前回はアルコール分子の構造を作成し、それを使ってアルコール二重膜系を作成した。 しかし、この構造を用いてシミュレーションを行うにあたって、GROMACSでこの分子を認識させ、力場を与えてやる必要がある。 今回はGROMACSでの力場の扱い方を学ぶためにCHARMM力場を導入し、アルコール分子のトポロジーをGROMACSに認識させて、実際にシミュレーションが開始できるまでの準備をする。</p>
<ol class="simple">
<li><p>CHARMM力場のダウンロード</p></li>
<li><p>CHARMMトポロジーの追加</p></li>
<li><p>構造ファイル（groファイル）の作成</p></li>
</ol>
<p>また、このページでもCHARMM力場のダウンロードのためにインターネット環境が必要である。 通信環境を確認しておこう。</p>
<div class="section" id="charmm">
<h2>CHARMM力場のダウンロード<a class="headerlink" href="#charmm" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>まず、シミュレーションに使用する力場を決定する。 チュートリアル①ではGROMACSにデフォルトでインストールされているOPLS-AA力場を使用したが、今回は新たな力場をインストールして使えるように設定する。</p>
<p>使用する力場はCHARMM36力場である。 <a class="reference external" href="http://mackerell.umaryland.edu/charmm_ff.shtml">CHARMM Force Field Files</a>にアクセスし、<strong>CHARMM36 Files for GROMACS</strong>のセクションから最新版のCHARMM36力場ファイル（charmm36-xxx.ff.tgz）をダウンロードする。</p>
<img src="https://shalad2.github.io/JellyPage/gromacs/images/charmm_ff.png" width=80%><p>ダウンロードできたら、このファイルをGROMACSが認識できる場所で展開する。 GROMACSをインストールした場所によって名前は異なるかもしれないが、
<code class="docutils literal notranslate"><span class="pre">~/App/gromacs-XXX/gmx_install/share/gromacs/top</span></code>
にcharmm36-xxx.ff.tgzを移動し、ここで中身を展開するだけでCHARMM36力場が使用可能となる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ダウンロードしたファイルを移動</span>
<span class="n">mv</span> <span class="n">charmm36</span><span class="o">-</span><span class="n">xxx</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">tgz</span> <span class="o">~/</span><span class="n">App</span><span class="o">/</span><span class="n">gromacs</span><span class="o">-</span><span class="n">XXX</span><span class="o">/</span><span class="n">gmx_install</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">gromacs</span><span class="o">/</span><span class="n">top</span><span class="o">/</span>
<span class="n">cd</span> <span class="o">~/</span><span class="n">App</span><span class="o">/</span><span class="n">gromacs</span><span class="o">-</span><span class="n">XXX</span><span class="o">/</span><span class="n">gmx_install</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">gromacs</span><span class="o">/</span><span class="n">top</span><span class="o">/</span>
<span class="c1"># ファイルを展開</span>
<span class="n">tar</span> <span class="n">xvf</span> <span class="n">charmm36</span><span class="o">-</span><span class="n">xxx</span><span class="o">.</span><span class="n">ff</span><span class="o">.</span><span class="n">tgz</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">App</span></code>や<code class="docutils literal notranslate"><span class="pre">gmx_install</span></code>などは<a class="reference external" href="https://shalad2.github.io/JellyPage/gromacs/gromacs_install.html">GROMACSのインストール</a>で紹介している場所なので、もし環境が異なるようであれば参考にしてほしい。</p>
<div class="section" id="id2">
<h3>CHARMMトポロジーの追加<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>CHARMM-GUIで作成したアルコール分子はオリジナルの分子であるため、GROMACSはデフォルトでこの分子を認識することができない。 そこで、GROMACSが認識できる分子一覧のファイルに今回作成したアルコール分子のトポロジーを与えてやることによって、この問題を解決できる。</p>
<p>アルコール分子のトポロジーファイルには原子情報と結合情報が含まれており、これは前回CHARMM-GUIで分子を作成した際に同時に生成している。 アルコール分子にLALという名前をつけたので、トポロジーファイルはCHARMM-GUIファイルの<code class="docutils literal notranslate"><span class="pre">lal</span></code>内の<code class="docutils literal notranslate"><span class="pre">lal.rtf</span></code>という名前になっているはずである。 テキストエディタで内容を確認すると、次のようになっている。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>lal.rtf
# 原子情報
RESI lal            0.000 ! param penalty=   0.000 ; charge penalty=   0.000
GROUP            ! CHARGE   CH_PENALTY
ATOM C1     CG331  -0.270 !    0.000
ATOM C2     CG321  -0.177 !    0.000
ATOM C3     CG321  -0.183 !    0.000
ATOM C4     CG321  -0.180 !    0.000
ATOM C5     CG321  -0.180 !    0.000

# 結合情報
BOND C1   C2  
BOND C2   C3  
BOND C3   C4  
BOND C4   C5  
BOND C5   C6
</pre></div>
</div>
<p>しかし、このトポロジーファイルはGROMACSの形式ではないため（ここが一番面倒だが）形式を変換してやる必要がある。 少し長いがサンプルを以下に示すので、コピーして使ってほしい。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="n">LAL</span> <span class="p">]</span> <span class="p">;</span> <span class="n">original</span> <span class="n">molecule</span> <span class="n">made</span> <span class="n">by</span> <span class="n">charmm</span><span class="o">-</span><span class="n">gui</span>
 <span class="p">[</span> <span class="n">atoms</span> <span class="p">]</span>
        <span class="n">C1</span>     <span class="n">CG331</span>  <span class="o">-</span><span class="mf">0.270</span>   <span class="mi">1</span>
        <span class="n">C2</span>     <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.177</span>   <span class="mi">2</span>
        <span class="n">C3</span>     <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.183</span>   <span class="mi">3</span>
        <span class="n">C4</span>     <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>   <span class="mi">4</span>
        <span class="n">C5</span>     <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>   <span class="mi">5</span>
        <span class="n">C6</span>     <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>   <span class="mi">6</span>
        <span class="n">C7</span>     <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>   <span class="mi">7</span>
        <span class="n">C8</span>     <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>   <span class="mi">8</span>
        <span class="n">C9</span>     <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>   <span class="mi">9</span>
        <span class="n">C10</span>    <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>  <span class="mi">10</span>
        <span class="n">C11</span>    <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>  <span class="mi">11</span>
        <span class="n">C12</span>    <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>  <span class="mi">12</span>
        <span class="n">C13</span>    <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>  <span class="mi">13</span>
        <span class="n">C14</span>    <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.180</span>  <span class="mi">14</span>
        <span class="n">C15</span>    <span class="n">CG321</span>  <span class="o">-</span><span class="mf">0.182</span>  <span class="mi">15</span>
        <span class="n">C16</span>    <span class="n">CG321</span>   <span class="mf">0.054</span>  <span class="mi">16</span>
        <span class="n">O</span>      <span class="n">OG311</span>  <span class="o">-</span><span class="mf">0.651</span>  <span class="mi">17</span>
        <span class="n">H1</span>     <span class="n">HGA3</span>    <span class="mf">0.090</span>  <span class="mi">18</span>
        <span class="n">H2</span>     <span class="n">HGA3</span>    <span class="mf">0.090</span>  <span class="mi">19</span>
        <span class="n">H3</span>     <span class="n">HGA3</span>    <span class="mf">0.090</span>  <span class="mi">20</span>
        <span class="n">H4</span>     <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">21</span>
        <span class="n">H5</span>     <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">22</span>
        <span class="n">H6</span>     <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">23</span>
        <span class="n">H7</span>     <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">24</span>
        <span class="n">H8</span>     <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">25</span>
        <span class="n">H9</span>     <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">26</span>
        <span class="n">H10</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">27</span>
        <span class="n">H11</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">28</span>
        <span class="n">H12</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">29</span>
        <span class="n">H13</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">30</span>
        <span class="n">H14</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">31</span>
        <span class="n">H15</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">32</span>
        <span class="n">H16</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">33</span>
        <span class="n">H17</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">34</span>
        <span class="n">H18</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">35</span>
        <span class="n">H19</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">36</span>
        <span class="n">H20</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">37</span>
        <span class="n">H21</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">38</span>
        <span class="n">H22</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">39</span>
        <span class="n">H23</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">40</span>
        <span class="n">H24</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">41</span>
        <span class="n">H25</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">42</span>
        <span class="n">H26</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">43</span>
        <span class="n">H27</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">44</span>
        <span class="n">H28</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">45</span>
        <span class="n">H29</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">46</span>
        <span class="n">H30</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">47</span>
        <span class="n">H31</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">48</span>
        <span class="n">H32</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">49</span>
        <span class="n">H33</span>    <span class="n">HGA2</span>    <span class="mf">0.090</span>  <span class="mi">50</span>
        <span class="n">H34</span>    <span class="n">HGP1</span>    <span class="mf">0.419</span>  <span class="mi">51</span>
 <span class="p">[</span> <span class="n">bonds</span> <span class="p">]</span>
        <span class="n">C1</span>   <span class="n">C2</span>
        <span class="n">C2</span>   <span class="n">C3</span>
        <span class="n">C3</span>   <span class="n">C4</span>
        <span class="n">C4</span>   <span class="n">C5</span>
        <span class="n">C5</span>   <span class="n">C6</span>
        <span class="n">C6</span>   <span class="n">C7</span>
        <span class="n">C7</span>   <span class="n">C8</span>
        <span class="n">C8</span>   <span class="n">C9</span>
        <span class="n">C9</span>   <span class="n">C10</span>
        <span class="n">C10</span>  <span class="n">C11</span>
        <span class="n">C11</span>  <span class="n">C12</span>
        <span class="n">C12</span>  <span class="n">C13</span>
        <span class="n">C13</span>  <span class="n">C14</span>
        <span class="n">C14</span>  <span class="n">C15</span>
        <span class="n">C15</span>  <span class="n">C16</span>
        <span class="n">C16</span>  <span class="n">O</span>
        <span class="n">C1</span>   <span class="n">H1</span>
        <span class="n">C1</span>   <span class="n">H2</span>
        <span class="n">C1</span>   <span class="n">H3</span>
        <span class="n">C2</span>   <span class="n">H4</span>
        <span class="n">C2</span>   <span class="n">H5</span>
        <span class="n">C3</span>   <span class="n">H6</span>
        <span class="n">C3</span>   <span class="n">H7</span>
        <span class="n">C4</span>   <span class="n">H8</span>
        <span class="n">C4</span>   <span class="n">H9</span>
        <span class="n">C5</span>   <span class="n">H10</span>
        <span class="n">C5</span>   <span class="n">H11</span>
        <span class="n">C6</span>   <span class="n">H12</span>
        <span class="n">C6</span>   <span class="n">H13</span>
        <span class="n">C7</span>   <span class="n">H14</span>
        <span class="n">C7</span>   <span class="n">H15</span>
        <span class="n">C8</span>   <span class="n">H16</span>
        <span class="n">C8</span>   <span class="n">H17</span>
        <span class="n">C9</span>   <span class="n">H18</span>
        <span class="n">C9</span>   <span class="n">H19</span>
        <span class="n">C10</span>  <span class="n">H20</span>
        <span class="n">C10</span>  <span class="n">H21</span>
        <span class="n">C11</span>  <span class="n">H22</span>
        <span class="n">C11</span>  <span class="n">H23</span>
        <span class="n">C12</span>  <span class="n">H24</span>
        <span class="n">C12</span>  <span class="n">H25</span>
        <span class="n">C13</span>  <span class="n">H26</span>
        <span class="n">C13</span>  <span class="n">H27</span>
        <span class="n">C14</span>  <span class="n">H28</span>
        <span class="n">C14</span>  <span class="n">H29</span>
        <span class="n">C15</span>  <span class="n">H30</span>
        <span class="n">C15</span>  <span class="n">H31</span>
        <span class="n">C16</span>  <span class="n">H32</span>
        <span class="n">C16</span>  <span class="n">H33</span>
        <span class="n">O</span>    <span class="n">H34</span>
</pre></div>
</div>
<p>このトポロジーを先程ダウンロード、展開したcharmm36-xxx.ffの中の<strong>merged.rtp</strong>というファイルの末尾に追加する。 merged.rtpにはGROMACSが認識できる分子の一覧が書かれているので、ここにトポロジーを追加することで新しい分子を扱うことが可能となる。</p>
<p>なお、既存のファイルを変更する時は必ずバックアップを取っておくようにしよう。</p>
</div>
</div>
<div class="section" id="gro">
<h2>構造ファイル（groファイル）の作成<a class="headerlink" href="#gro" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>最後に、GROMACSが新しい力場と分子を正しく認識し、構造ファイルを作成できることを確認しておく。 以前のチュートリアルでも扱った通り、groファイルの作成には<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">pdb2gmx</span></code>を使用する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">pdb2gmx</span> <span class="o">-</span><span class="n">f</span> <span class="n">system</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">o</span> <span class="n">system</span><span class="o">.</span><span class="n">gro</span>
</pre></div>
</div>
<p>コマンドを実行すると、力場の選択画面になる。 これまでの設定が正しくできているとCHARMM36が選択できるはずである。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="n">the</span> <span class="n">Force</span> <span class="n">Field</span><span class="p">:</span>
<span class="n">From</span> <span class="s1">&#39;/home/user/App/gromacs-XXX/gmx_install/share/gromacs/top&#39;</span><span class="p">:</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">AMBER03</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Duan</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span> <span class="n">Comp</span><span class="o">.</span> <span class="n">Chem</span><span class="o">.</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">1999</span><span class="o">-</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">2003</span><span class="p">)</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">AMBER94</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">Cornell</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">JACS</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">5179</span><span class="o">-</span><span class="mi">5197</span><span class="p">,</span> <span class="mi">1995</span><span class="p">)</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">AMBER96</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Kollman</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">Acc</span><span class="o">.</span> <span class="n">Chem</span><span class="o">.</span> <span class="n">Res</span><span class="o">.</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">461</span><span class="o">-</span><span class="mi">469</span><span class="p">,</span> <span class="mi">1996</span><span class="p">)</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">AMBER99</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Wang</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">J</span><span class="o">.</span> <span class="n">Comp</span><span class="o">.</span> <span class="n">Chem</span><span class="o">.</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">1049</span><span class="o">-</span><span class="mi">1074</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
<span class="mi">5</span><span class="p">:</span> <span class="n">AMBER99SB</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Hornak</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">Proteins</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">712</span><span class="o">-</span><span class="mi">725</span><span class="p">,</span> <span class="mi">2006</span><span class="p">)</span>
<span class="mi">6</span><span class="p">:</span> <span class="n">AMBER99SB</span><span class="o">-</span><span class="n">ILDN</span> <span class="n">protein</span><span class="p">,</span> <span class="n">nucleic</span> <span class="n">AMBER94</span> <span class="p">(</span><span class="n">Lindorff</span><span class="o">-</span><span class="n">Larsen</span> <span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">,</span> <span class="n">Proteins</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">1950</span><span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>
<span class="mi">7</span><span class="p">:</span> <span class="n">AMBERGS</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">Garcia</span> <span class="o">&amp;</span> <span class="n">Sanbonmatsu</span><span class="p">,</span> <span class="n">PNAS</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">2782</span><span class="o">-</span><span class="mi">2787</span><span class="p">,</span> <span class="mi">2002</span><span class="p">)</span>
<span class="mi">8</span><span class="p">:</span> <span class="n">CHARMM27</span> <span class="nb">all</span><span class="o">-</span><span class="n">atom</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">CHARM22</span> <span class="n">plus</span> <span class="n">CMAP</span> <span class="k">for</span> <span class="n">proteins</span><span class="p">)</span>
<span class="mi">9</span><span class="p">:</span> <span class="n">CHARMM36</span> <span class="nb">all</span><span class="o">-</span><span class="n">atom</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">July</span> <span class="mi">2020</span><span class="p">)</span>
<span class="mi">10</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">43</span><span class="n">a1</span> <span class="n">force</span> <span class="n">field</span>
<span class="mi">11</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">43</span><span class="n">a2</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">improved</span> <span class="n">alkane</span> <span class="n">dihedrals</span><span class="p">)</span>
<span class="mi">12</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">45</span><span class="n">a3</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">Schuler</span> <span class="n">JCC</span> <span class="mi">2001</span> <span class="mi">22</span> <span class="mi">1205</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">53</span><span class="n">a5</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">JCC</span> <span class="mi">2004</span> <span class="n">vol</span> <span class="mi">25</span> <span class="n">pag</span> <span class="mi">1656</span><span class="p">)</span>
<span class="mi">14</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">53</span><span class="n">a6</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">JCC</span> <span class="mi">2004</span> <span class="n">vol</span> <span class="mi">25</span> <span class="n">pag</span> <span class="mi">1656</span><span class="p">)</span>
<span class="mi">15</span><span class="p">:</span> <span class="n">GROMOS96</span> <span class="mi">54</span><span class="n">a7</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="n">Eur</span><span class="o">.</span> <span class="n">Biophys</span><span class="o">.</span> <span class="n">J</span><span class="o">.</span> <span class="p">(</span><span class="mi">2011</span><span class="p">),</span> <span class="mi">40</span><span class="p">,,</span> <span class="mi">843</span><span class="o">-</span><span class="mi">856</span><span class="p">,</span> <span class="n">DOI</span><span class="p">:</span> <span class="mf">10.1007</span><span class="o">/</span><span class="n">s00249</span><span class="o">-</span><span class="mi">011</span><span class="o">-</span><span class="mi">0700</span><span class="o">-</span><span class="mi">9</span><span class="p">)</span>
<span class="mi">16</span><span class="p">:</span> <span class="n">OPLS</span><span class="o">-</span><span class="n">AA</span><span class="o">/</span><span class="n">L</span> <span class="nb">all</span><span class="o">-</span><span class="n">atom</span> <span class="n">force</span> <span class="n">field</span> <span class="p">(</span><span class="mi">2001</span> <span class="n">aminoacid</span> <span class="n">dihedrals</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">9</span></code>を選択して次へ進むと、使用する水モデルの種類を聞かれる。 前回はSPE/Cモデルを使用したが、今回はTIP3Pモデルを使用する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="n">the</span> <span class="n">Water</span> <span class="n">Model</span><span class="p">:</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">TIP3P</span>	<span class="n">TIP</span> <span class="mi">3</span><span class="o">-</span><span class="n">point</span><span class="p">,</span> <span class="n">recommended</span><span class="p">,</span> <span class="n">by</span> <span class="n">default</span> <span class="n">uses</span> <span class="n">CHARMM</span> <span class="n">TIP3</span> <span class="k">with</span> <span class="n">LJ</span> <span class="n">on</span> <span class="n">H</span>
<span class="mi">2</span><span class="p">:</span> <span class="n">TIP4P</span>	<span class="n">TIP</span> <span class="mi">4</span><span class="o">-</span><span class="n">point</span>
<span class="mi">3</span><span class="p">:</span> <span class="n">TIP5P</span>	<span class="n">TIP</span> <span class="mi">5</span><span class="o">-</span><span class="n">point</span>
<span class="mi">4</span><span class="p">:</span> <span class="n">SPC</span>		<span class="n">simple</span> <span class="n">point</span> <span class="n">charge</span>
<span class="mi">5</span><span class="p">:</span> <span class="n">SPC</span><span class="o">/</span><span class="n">E</span>	<span class="n">extended</span> <span class="n">simple</span> <span class="n">point</span> <span class="n">charge</span>
<span class="mi">6</span><span class="p">:</span> <span class="kc">None</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">1</span></code>を選択し、何もエラーが出なければgroファイルが生成されているであろう。 また同時に、大量のトポロジーファイルと位置拘束ファイルが生成されているであろう。 これでは扱うファイルが増えてしまい、見た目もあまりよくないので、ここからはファイルを1つにまとめてみたいと思う。</p>
<p>現在<code class="docutils literal notranslate"><span class="pre">gmx</span> <span class="pre">pdb2gmx</span></code>をしたことでトポロジーファイルが自動生成されたが、PDBファイルに含まれているアルコール分子256個が別々のファイルに分けられてしまっている。 しかしながら、256個のアルコール分子は全て同じものであるので、わざわざファイルを分ける必要はなく、むしろ全て同じトポロジーファイルを利用することが望ましい。 従って、topol_Other.itp及びposre_Other.itpのみを残して、topol_OtherXXX.itpやposre_OtherXXX.itpなどは全て削除してしまおう。 （ただし、topol.topは残しておくこと）</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># 生成したファイル（一部のみ抜粋）</span>
<span class="n">posre_Other</span><span class="o">.</span><span class="n">itp</span>       <span class="n">topol_Other</span><span class="o">.</span><span class="n">itp</span>
<span class="n">posre_Other2</span><span class="o">.</span><span class="n">itp</span>      <span class="n">topol_Other2</span><span class="o">.</span><span class="n">itp</span>
<span class="n">posre_Other3</span><span class="o">.</span><span class="n">itp</span>      <span class="n">topol_Other3</span><span class="o">.</span><span class="n">itp</span>

<span class="n">posre_Other256</span><span class="o">.</span><span class="n">itp</span>    <span class="n">topol_Other256</span><span class="o">.</span><span class="n">itp</span>
<span class="n">topol</span><span class="o">.</span><span class="n">top</span>
<span class="c1"># posre_Other.itp, topol_Other.itp, topol.topのみを残して、他のitpファイルを全て削除</span>
</pre></div>
</div>
<p>さらに、系全体のトポロジーファイルであるtopol.topを編集する。 「Include chain topologies」の項目に削除したファイル一覧があるので、topol_Other.itpのみを残して他を削除する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">topol</span><span class="o">.</span><span class="n">top</span> <span class="p">(</span><span class="n">modified</span><span class="p">)</span>
<span class="p">;</span> <span class="n">Include</span> <span class="n">chain</span> <span class="n">topologies</span>
<span class="c1">#include &quot;topol_Other.itp&quot;</span>
</pre></div>
</div>
<p>また、ファイル末尾の[ molecules ]のセクションでも同様の修正をして、Otherの分子数を256に変更する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">topol</span><span class="o">.</span><span class="n">top</span> <span class="p">(</span><span class="n">modified</span><span class="p">)</span>
<span class="p">[</span> <span class="n">moleules</span> <span class="p">]</span>
<span class="p">;</span> <span class="n">Compound</span>      <span class="c1">#mols</span>
<span class="n">Other</span>             <span class="mi">256</span>
<span class="n">SOL</span>              <span class="mi">7680</span>
</pre></div>
</div>
<p>変更を保存して、次の5つのファイルが手元にあれば、ここまでの操作は完了となる。 なお、ここからsystem.pdbとposre_Other.itpは使用しないが、削除せずに残しておこう。</p>
<ol class="simple">
<li><p>system.pdb</p></li>
<li><p>system.gro</p></li>
<li><p>topol.top</p></li>
<li><p>topol_Other.itp</p></li>
<li><p>posre_Other.itp</p></li>
</ol>
</div>
<div class="section" id="id3">
<h2>まとめ<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>ここまで、アルコール二重膜の力場とトポロジーの設定を行い、GROMACSでシミュレーションを実行できるところまで辿り着いた。 今回の設定をまとめると次の通りである。</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CHARMM36力場</span></code>をダウンロードし、GROMACSで読み込めるようにした。</p></li>
<li><p>アルコール分子のトポロジーを<code class="docutils literal notranslate"><span class="pre">merged.rtp</span></code>に追加し、GROMACSで分子を扱えるようにした。</p></li>
<li><p>groファイルを作成し、系全体のトポロジーファイルを修正した。</p></li>
</ol>
<p>次回は作成したgroファイルとトポロジーファイルを用いてシミュレーションを実行する。 シミュレーションの設定ファイルであるmdpファイルの詳細を学んでいこう。</p>
<p><a class="reference external" href="https://shalad2.github.io/JellyPage/gromacs/gromacs_tutorial2_1.html">PREVIOUS</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="GROMACS%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB2.3.html" class="btn btn-neutral float-right" title="3. mdpファイルの作成とシミュレーションの実行" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="GROMACS%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB2.1.html" class="btn btn-neutral float-left" title="1. 系の作成" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, S.Harada,I.Kawabata,S.Ikeda,K.Shibata.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>